[env:esp32dev]
platform = espressif32
board = esp32dev
framework = arduino
board_build.partitions = partitions_ota.csv

; Ottimizzazioni per ridurre dimensione firmware e aumentare stack
build_flags =
    -DCORE_DEBUG_LEVEL=0
    -Os
    -DCONFIG_ARDUINO_LOOP_STACK_SIZE=16384
    -DCONFIG_ASYNC_TCP_MAX_ACK_TIME=5000
    -DCONFIG_ASYNC_TCP_PRIORITY=10
    -DCONFIG_ASYNC_TCP_RUNNING_CORE=1
    -DCONFIG_ASYNC_TCP_STACK_SIZE=8192

; Configurazione porta seriale

; Librerie necessarie per Web OTA e WebSocket Logging
lib_deps =
    WebServer
    fastled/FastLED@^3.7.0
    ottowinter/ESPAsyncWebServer-esphome@^3.1.0
    me-no-dev/AsyncTCP@^1.1.1

; Configurazione OTA (commentata - prima upload USB)
; upload_protocol = espota
; upload_port = 192.168.1.91
; upload_flags =
;     --port=3232
;     --auth=admin
;     --timeout=60

; --- Opzioni di Upload USB (ATTIVE) ---
upload_protocol = esptool
upload_port = /dev/ttyUSB0
upload_speed = 921600

; --- Opzioni Monitor Seriale ---
monitor_port = /dev/ttyUSB0
monitor_speed = 115200
monitor_dtr = 0
monitor_rts = 0
