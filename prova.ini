; PlatformIO Project Configuration File
;
;   Build options: build flags, source filter
;   Upload options: custom upload port, speed and extra flags
;   Library options: dependencies, extra library storages
;   Advanced options: extra scripting
;
; Please visit documentation for the other options and examples
; https://docs.platformio.org/page/projectconf.html

[env:esp32cam]
platform = espressif32
board = esp32cam
framework = arduino
lib_deps = fastled/FastLED

; CRITICO per OTA su ESP32-CAM: Usa partizione che lascia spazio per OTA
; La partizione default "huge_app" occupa tutta la memoria e blocca l'OTA!
board_build.partitions = min_spiffs.csv

; Disabilita brownout detector per evitare reset durante WiFi/OTA
build_flags =
    -D CORE_DEBUG_LEVEL=3
    -D CONFIG_ESP32_BROWNOUT_DET=0

; --- Opzioni di Upload USB (debug - watchdog disabilitato) ---
upload_protocol = esptool
upload_port = /dev/ttyUSB0
upload_speed = 115200

; --- Opzioni Monitor Seriale ---
monitor_port = /dev/ttyUSB0
monitor_speed = 115200
monitor_dtr = 0
monitor_rts = 0

; --- Environment separato per OTA Upload ---
[env:esp32cam-ota]
platform = espressif32
board = esp32cam
framework = arduino
board_build.partitions = min_spiffs.csv

; Disabilita brownout detector
build_flags =
    -D CORE_DEBUG_LEVEL=3
    -D CONFIG_ESP32_BROWNOUT_DET=0

upload_protocol = espota
upload_port = 192.168.1.92
upload_flags =
    --timeout=30
    --port=3232